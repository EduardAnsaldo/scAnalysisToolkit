% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cnmf_analysis.r
\name{run_cnmf_results}
\alias{run_cnmf_results}
\title{Run cNMF Gene Expression Program Analysis}
\usage{
run_cnmf_results(
  seurat,
  data_dir,
  runname,
  k_used = 6,
  local_density_threshold = 0.1,
  do_cnmf = TRUE,
  sequential_palette = NULL,
  sequential_palette_dotplot = NULL,
  color_palette = NULL,
  output_path = here::here("results", "cNMF", runname, "outputs"),
  object_annotations = "",
  top_n = 100,
  topn_plot = 6,
  run_pathway_enrichment = NULL,
  ...
)
}
\arguments{
\item{seurat}{Seurat object with gene expression data}

\item{data_dir}{Character; path to directory containing cNMF run folder}

\item{runname}{Character; cNMF run name identifier}

\item{k_used}{Integer; number of gene expression programs (components) to use. Default 6}

\item{local_density_threshold}{Numeric; threshold for consensus clustering. Default 0.1}

\item{do_cnmf}{Logical; whether to run system cNMF consensus command. Default TRUE}

\item{sequential_palette}{Character vector; color palette for FeaturePlot. Default NULL}

\item{sequential_palette_dotplot}{Character vector; color palette for DotPlot. Default NULL}

\item{color_palette}{Character vector; color palette for gene loading heatmap. Default NULL}

\item{output_path}{Character; path to save output files. Default here::here('results', 'cNMF', runname, 'outputs')}

\item{object_annotations}{Character; string to append to output file names. Default ''}

\item{top_n}{Integer; number of top genes per program to extract. Default 100}

\item{topn_plot}{Integer; number of top genes per program for heatmap visualization. Default 6}

\item{run_pathway_enrichment}{Character vector; enrichment methods ('Metascape',
'ClusterProfiler', or NULL). Default NULL}

\item{...}{Additional arguments passed to pathway enrichment functions}
}
\value{
List with elements:
\item{seurat}{Seurat object with cNMF program scores added to metadata}
\item{top_colnames_long}{Long-format data frame of top genes with annotations}
\item{top_colnames}{Wide-format data frame of top genes per program}
\item{ORA_results}{Pathway overrepresentation analysis results or NULL}
\item{genes_score_table}{Data frame of gene loadings for visualization}
\item{spectra_score}{Matrix of gene spectra scores}
}
\description{
Performs comprehensive consensus Non-negative Matrix Factorization (cNMF) analysis
to identify gene expression programs (GEPs) in single-cell data. Optionally runs
cNMF consensus command, loads results, normalizes program usage scores, creates
visualizations (UMAP feature plots, violin plots, heatmaps), and performs pathway
enrichment analysis on top genes per program.
}
