% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seurat_clustering.r
\name{process_multimodal_seurat}
\alias{process_multimodal_seurat}
\title{Process Multimodal Seurat Object with RNA and ATAC Data}
\usage{
process_multimodal_seurat(
  seurat,
  figures_path = NULL,
  object_annotations = NULL,
  dimensions_RNA = NULL,
  dimensions_ATAC = NULL,
  resolution_RNA = NULL,
  resolution_ATAC = NULL,
  resolution_WNN = NULL,
  resolutions_RNA = c(0.375, 0.4, 0.475, 0.5, 0.55, 0.6, 0.625, 0.75, 1),
  resolutions_ATAC = c(0.1, 0.25, 0.3, 0.325, 0.375, 0.5, 0.625, 0.75, 1),
  resolutions_WNN = c(0.1, 0.25, 0.375, 0.5, 0.625, 0.75, 1, 1.25, 1.5),
  npcs = 50,
  ndims_lsi = 40,
  random_seed = 3514,
  remove_ig = FALSE,
  genome = "GRCm39",
  generate_plots = TRUE,
  skip_preprocessing = FALSE,
  skip_umap_and_neighbors = FALSE
)
}
\arguments{
\item{seurat}{A Seurat object containing both RNA and ATAC assays}

\item{figures_path}{Character string specifying the directory path where
generated plots should be saved. Required if \code{generate_plots = TRUE}.}

\item{object_annotations}{Character string used as prefix for saved plot filenames.
Required if \code{generate_plots = TRUE}.}

\item{dimensions_RNA}{Integer specifying the number of principal components to
use for RNA data. If NULL, function stops after PCA to allow examination of
elbow plot.}

\item{dimensions_ATAC}{Integer specifying the upper dimension for ATAC LSI
components (dimension 1 is excluded). If NULL, function stops after LSI to
allow examination of elbow plot.}

\item{resolution_RNA}{Numeric value specifying the clustering resolution for
RNA data. If NULL, function stops after showing resolution exploration plots.}

\item{resolution_ATAC}{Numeric value specifying the clustering resolution for
ATAC data. If NULL, function stops after showing resolution exploration plots.}

\item{resolution_WNN}{Numeric value specifying the clustering resolution for
weighted nearest neighbor analysis. If NULL, function stops after showing
resolution exploration plots.}

\item{resolutions_RNA}{Numeric vector of resolution values to explore for RNA
clustering. Default: c(0.375, 0.4, 0.475, 0.5, 0.55, 0.6, 0.625, 0.75, 1)}

\item{resolutions_ATAC}{Numeric vector of resolution values to explore for ATAC
clustering. Default: c(0.1, 0.25, 0.3, 0.325, 0.375, 0.5, 0.625, 0.75, 1)}

\item{resolutions_WNN}{Numeric vector of resolution values to explore for WNN
clustering. Default: c(0.1, 0.25, 0.375, 0.5, 0.625, 0.75, 1, 1.25, 1.5)}

\item{npcs}{Integer specifying the number of principal components to compute
for RNA PCA. Default: 50}

\item{ndims_lsi}{Integer specifying the number of LSI dimensions to compute
for ATAC data. Default: 40}

\item{random_seed}{Integer seed for reproducibility in clustering algorithms.
Default: 3514}

\item{remove_ig}{Logical indicating whether to filter out immunoglobulin-related
features from both RNA and ATAC data. Default: FALSE}

\item{generate_plots}{Logical indicating whether to generate and save final
plots. Requires \code{figures_path} and \code{object_annotations} to be specified.
Default: TRUE}

\item{skip_preprocessing}{Logical indicating whether to skip RNA/ATAC normalization
and dimensionality reduction steps. Use TRUE when rerunning after examining
elbow plots. Default: FALSE}

\item{skip_umap_and_neighbors}{Logical indicating whether to skip UMAP generation
and neighbor finding steps. Use TRUE when rerunning after selecting dimensions
to only redo clustering. Default: FALSE}
}
\value{
A list containing:
\item{seurat}{The processed Seurat object with added reductions and clustering}
\item{stage}{Character string indicating completion stage: "dimensions",
"resolutions", or "complete"}
\item{missing}{Character vector of missing parameters (only if stage != "complete")}
}
\description{
This function performs comprehensive processing of multimodal single-cell data
including RNA and ATAC-seq modalities. It handles normalization, dimensionality
reduction, clustering, and weighted nearest neighbor (WNN) analysis. The function
can operate in interactive mode, stopping at key decision points to allow
examination of diagnostic plots.
}
\details{
The function performs the following steps:
\enumerate{
\item RNA Processing: SCTransform normalization, removal of immunoglobulin
genes from variable features, and PCA
\item ATAC Processing: Feature selection, removal of immunoglobulin loci,
TF-IDF normalization, and LSI dimensionality reduction
\item Interactive dimension selection based on elbow plots
\item UMAP generation for both modalities
\item Clustering exploration across multiple resolutions
\item Weighted Nearest Neighbor (WNN) analysis integrating both modalities
\item Optional generation of comprehensive visualization plots
}

When \code{remove_ig = TRUE}, the function automatically filters out immunoglobulin-related features:
\itemize{
\item RNA: Genes matching patterns "Igh", "Igl", or "Igk"
\item ATAC: Peaks overlapping genomic regions chr12:113222388-115937574 (Igh),
chr6:67532620-70703738 (Igk), and chr16:18845608-19079594 (Igl)
}
}
\note{
This function uses the Leiden algorithm (algorithm = 4) for clustering.
The first LSI component is excluded from ATAC analysis as it typically
correlates with sequencing depth.
}
\examples{
\dontrun{
# Interactive mode - examine plots at each stage
result <- process_multimodal_seurat(seurat_obj)

# After examining elbow plots, specify dimensions and skip preprocessing
result <- process_multimodal_seurat(
  seurat_obj,
  dimensions_RNA = 30,
  dimensions_ATAC = 25,
  skip_preprocessing = TRUE
)

# After examining clustering, specify resolutions and skip earlier steps
result <- process_multimodal_seurat(
  seurat_obj,
  dimensions_RNA = 30,
  dimensions_ATAC = 25,
  resolution_RNA = 0.5,
  resolution_ATAC = 0.3,
  resolution_WNN = 0.5,
  skip_preprocessing = TRUE,
  skip_umap_and_neighbors = TRUE
)
}

}
