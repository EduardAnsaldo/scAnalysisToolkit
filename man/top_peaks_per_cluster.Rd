% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential_accessibility.r
\name{top_peaks_per_cluster}
\alias{top_peaks_per_cluster}
\title{Find Top Differentially Accessible Peaks Per Cluster}
\usage{
top_peaks_per_cluster(
  seurat,
  n_genes_to_plot = 3,
  grouping_var = "seurat_clusters_atac",
  object_annotations = "",
  tables_path = "results/tables/",
  figures_path = "results/figures/",
  results_path = "results/",
  run_pathway_enrichment = NULL,
  ...
)
}
\arguments{
\item{seurat}{Seurat object with ATAC assay and cluster assignments}

\item{n_genes_to_plot}{Integer; number of top peaks per cluster for visualization.
Default 3}

\item{grouping_var}{Character; metadata column name for cluster identity.
Default 'seurat_clusters_atac'}

\item{object_annotations}{Character; string to append to output file names. Default ''}

\item{tables_path}{Character; path to save output tables. Default 'results/tables/'}

\item{figures_path}{Character; path to save figures. Default 'results/figures/'}

\item{results_path}{Character; path for pathway enrichment results. Default 'results/'}

\item{run_pathway_enrichment}{Character vector; enrichment methods to run
('Metascape', 'ClusterProfiler', or NULL). Default NULL}

\item{...}{Additional arguments passed to ClusterProfiler analysis}
}
\value{
List with elements:
\item{ClusterProfiler_results}{ClusterProfiler enrichment results or NULL}
\item{metascape_results}{Metascape enrichment results or NULL}
\item{topn}{Data frame; top n peaks per cluster}
\item{da_results}{Data frame; all differential accessibility results}
}
\description{
Identifies differentially accessible chromatin regions for each cluster using
Seurat's FindAllMarkers on ATAC-seq data. Maps peaks to nearest genes and
optionally performs pathway enrichment analysis. Saves ranked peak lists
(top 10, 50, 100) to TSV files.
}
