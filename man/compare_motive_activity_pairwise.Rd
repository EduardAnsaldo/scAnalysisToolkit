% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential_accessibility.r
\name{compare_motive_activity_pairwise}
\alias{compare_motive_activity_pairwise}
\title{Compare Motif Activity Between Two Clusters}
\usage{
compare_motive_activity_pairwise(
  seurat,
  cluster_id,
  other_cluster_id,
  figures_path,
  identities = "seurat_clusters_atac",
  reduction = "umap.wnn",
  topn = 9,
  JASPARConnect,
  sequential_palette,
  ...
)
}
\arguments{
\item{seurat}{A Seurat object containing chromVAR and ATAC assays}

\item{cluster_id}{Character or numeric. The primary cluster identifier to compare}

\item{other_cluster_id}{Character or numeric. The comparison cluster identifier}

\item{identities}{Character. The metadata column to use for cell identities.
Default is 'seurat_clusters_atac'}

\item{reduction}{Character. The dimensional reduction to use for feature plots.
Default is 'umap.wnn'}

\item{topn}{Numeric. Number of top motifs to display for up and down-regulated
activities. Default is 9}

\item{JASPARConnect}{A JASPAR database connection object for retrieving motif
information and sequence logos}

\item{sequential_palette}{Color palette for feature plots}

\item{...}{Additional arguments passed to volcano_plot function}
}
\value{
A data frame of differential motif activities with columns:
\itemize{
\item avg_diff: Average difference in chromVAR scores
\item p_val: P-value from likelihood ratio test
\item p_val_adj: Adjusted p-value
\item pct.1: Percentage of cells in cluster_id
\item pct.2: Percentage of cells in other_cluster_id
\item motif_name: Human-readable motif name from JASPAR
}
}
\description{
This function performs pairwise comparison of transcription factor motif activities
between two specified clusters using ChromVAR scores. It identifies differentially
active motifs and generates visualization plots including volcano plots, motif
sequence logos, UMAP feature plots, and violin plots.
}
\details{
The function performs the following steps:
\enumerate{
\item Runs FindMarkers using likelihood ratio test on chromVAR scores,
controlling for ATAC fragment counts
\item Identifies top up-regulated motifs (avg_diff > 0, padj < 0.05)
\item Identifies top down-regulated motifs (avg_diff < 0, padj < 0.05)
\item Generates a volcano plot of all differential motif activities
\item For both up and down-regulated sets:
\itemize{
\item Displays motif sequence logos
\item Creates UMAP feature plots showing motif activity
\item Generates violin plots comparing activity between clusters
}
\item Annotates results with motif names from JASPAR database
}
}
\note{
This function requires the following packages: Seurat, Signac, TFBSTools,
patchwork, dplyr, purrr, scCustomize
}
\examples{
\dontrun{
# Compare motif activities between cluster 1 and cluster 2
diff_motifs <- compare_motive_activity_pairwise(
  seurat = my_seurat,
  cluster_id = 1,
  other_cluster_id = 2,
  JASPARConnect = jaspar_db,
  sequential_palette = viridis::viridis(100)
)
}

}
