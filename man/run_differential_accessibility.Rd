% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential_accessibility.r
\name{run_differential_accessibility}
\alias{run_differential_accessibility}
\title{Complete Differential Accessibility Analysis Pipeline}
\usage{
run_differential_accessibility(
  seurat,
  comparison,
  group1,
  group2,
  is_integrated_subset = FALSE,
  cluster = "all_clusters",
  path = "./",
  FC_threshold = 0.3,
  p_value_threshold = 0.05,
  min_fraction = 0.05,
  max_overlaps = 15,
  label_size = 5,
  pathways_of_interest = NULL,
  label_threshold = 1e+05,
  gene_lists_to_plot = NULL,
  colors = c("green4", "darkorchid4"),
  minimum_cell_number = 30,
  run_pathway_enrichment = NULL,
  ...
)
}
\arguments{
\item{seurat}{Seurat object with ATAC assay and chromatin accessibility data}

\item{comparison}{Character; metadata column name for comparison groups}

\item{group1}{Character; pattern to match for first group (control)}

\item{group2}{Character; pattern to match for second group (treatment)}

\item{is_integrated_subset}{Logical; currently unused, maintained for consistency.
Default FALSE}

\item{cluster}{Character; cluster or cell type identifier. Default 'all_clusters'}

\item{path}{Character; output directory path. Default './'}

\item{FC_threshold}{Numeric; log2 fold change threshold for filtering. Default 0.3}

\item{p_value_threshold}{Numeric; adjusted p-value threshold. Default 0.05}

\item{min_fraction}{Numeric; minimum fraction of cells with accessible peak. Default 0.05}

\item{max_overlaps}{Integer; maximum label overlaps in plots. Default 15}

\item{label_size}{Numeric; size of peak/gene labels in plots. Default 5}

\item{pathways_of_interest}{Character vector; specific pathways to analyze. Default NULL}

\item{label_threshold}{Numeric; accessibility threshold for labeling peaks. Default 100000}

\item{gene_lists_to_plot}{Named list; custom gene lists to visualize. Default NULL}

\item{colors}{Character vector of length 2; colors for DOWN and UP peaks.
Default c('green4', 'darkorchid4')}

\item{minimum_cell_number}{Integer; minimum cells required per group. Default 30}

\item{run_pathway_enrichment}{Character; method for pathway enrichment or NULL. Default NULL}

\item{...}{Additional arguments passed to core analysis and visualization functions}
}
\value{
List with elements:
\item{all_count}{Integer; number of significant differentially accessible peaks}
\item{UP_count}{Integer; number of more accessible peaks}
\item{DOWN_count}{Integer; number of less accessible peaks}
\item{results}{Data frame; complete DA results}
}
\description{
Orchestrates a full ATAC-seq differential accessibility analysis workflow including
statistical testing, volcano plot generation for both peak regions and nearest genes,
and optional pathway enrichment analysis. Creates two volcano plots: one labeled
with peak coordinates and one with nearest gene names.
}
\examples{
results <- run_differential_accessibility(seurat_atac, "condition", "WT", "KO",
                                         cluster = "Macrophages",
                                         run_pathway_enrichment = "Metascape")
}
