% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/repertoire_analysis.r
\name{calculate_D50}
\alias{calculate_D50}
\title{Calculate D50 TCR Diversity Metric}
\usage{
calculate_D50(
  seurat,
  cell_grouping_var,
  replicate_var,
  replicate_group_var = NULL,
  results_path,
  figures_path,
  tables_path,
  colors = NULL
)
}
\arguments{
\item{seurat}{Seurat object with TCR repertoire metadata from scRepertoire}

\item{cell_grouping_var}{Unquoted column name; cell type or cluster grouping variable}

\item{replicate_var}{Unquoted column name; biological replicate identifier (e.g., sample ID)}

\item{replicate_group_var}{Unquoted column name; grouping of replicates for plotting
(e.g., experimental condition). If NULL, uses replicate_var. Default NULL}

\item{results_path}{Character; path for saving DESeq2::results (currently unused)}

\item{figures_path}{Character; path to save D50 bar plot}

\item{tables_path}{Character; path to save D50 table CSV}

\item{colors}{Named character vector; colors for replicate_group_var levels. If NULL,
uses ggplot2 defaults. Default NULL}
}
\value{
ggplot object showing D50 values per cell type and replicate group with
mean bars and error bars
}
\description{
Computes the D50 diversity index for T cell receptor repertoires across cell types
and replicates. D50 measures the proportion of unique clonotypes needed to account
for the most abundant 50\% of cells. Higher D50 indicates greater clonal diversity.
Requires at least 20 cells per group for reliable calculation.
}
