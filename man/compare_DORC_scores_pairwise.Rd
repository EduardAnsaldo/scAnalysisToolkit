% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GRN_analysis_FigR.r
\name{compare_DORC_scores_pairwise}
\alias{compare_DORC_scores_pairwise}
\title{Compare DORC Scores Between Two Clusters in a Pairwise Manner}
\usage{
compare_DORC_scores_pairwise(
  seurat,
  dorcMat.s,
  umap.d,
  cluster_id,
  other_cluster_id,
  figures_path,
  identities = "seurat_clusters_atac",
  topn = 9,
  ...
)
}
\arguments{
\item{seurat}{A Seurat object containing DORCs assay with chromatin accessibility data}

\item{dorcMat.s}{Matrix containing DORC (Domain of Regulatory Chromatin) activity scores}

\item{umap.d}{Data frame or matrix containing UMAP coordinates for dimensionality reduction}

\item{cluster_id}{Character or numeric. The primary cluster identifier (ident.1) for comparison}

\item{other_cluster_id}{Character or numeric. The comparison cluster identifier (ident.2)}

\item{figures_path}{Character. Directory path where output plots will be saved.
Should exist before function call}

\item{identities}{Character. Column name in metadata to use for cell identities.
Default is 'seurat_clusters_atac'}

\item{topn}{Numeric. Number of top differentially active genes to visualize for both
up and downregulated genes. Default is 9}

\item{...}{Additional arguments passed to volcano_plot function}
}
\value{
A data frame containing differential activity results with the following columns:
\itemize{
\item Gene names as row names
\item p_val: Raw p-values from differential testing
\item avg_diff: Average difference in activity between clusters
\item pct.1: Percentage of cells in cluster_id with detected activity
\item pct.2: Percentage of cells in other_cluster_id with detected activity
\item p_val_adj: Bonferroni-corrected p-values
}

The function performs the following workflow:
\enumerate{
\item Sets the default assay to 'DORCs' and identities to specified column
\item Runs FindMarkers using Wilcoxon rank sum test on the DORCs assay
\item Identifies top upregulated genes (avg_diff > 0, padj < 0.05)
\item Identifies top downregulated genes (avg_diff < 0, padj < 0.05)
\item Generates a volcano plot of differential activity (saved to figures_path)
\item Creates side-by-side DORC and RNA expression plots for top upregulated genes
\item Creates side-by-side DORC and RNA expression plots for top downregulated genes
\item Saves all individual gene plots as PNG files to figures_path
}View top differentially active genes

head(results)
}
}
\description{
This function performs differential activity analysis between two specified clusters
in a Seurat object and generates visualization plots for top differentially expressed
genes (DORCs). It identifies genes with significantly higher or lower activity in
one cluster compared to another and creates combined DORC and RNA expression plots.
}
\seealso{
\code{\link[Seurat]{FindMarkers}} for differential expression testing
}
