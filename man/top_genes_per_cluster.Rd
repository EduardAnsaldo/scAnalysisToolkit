% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster_annotation.r
\name{top_genes_per_cluster}
\alias{top_genes_per_cluster}
\title{Find and Visualize Top Marker Genes Per Cluster}
\usage{
top_genes_per_cluster(
  seurat,
  n_genes_to_plot = 3,
  grouping_var = "seurat_clusters",
  object_annotations = "",
  tables_path = "results/tables/",
  figures_path = "results/figures/",
  results_path = "results/",
  run_pathway_enrichment = NULL,
  filter_ig = FALSE,
  filter_tcr = FALSE,
  ...
)
}
\arguments{
\item{seurat}{Seurat object with cluster assignments}

\item{n_genes_to_plot}{Integer; number of top genes per cluster to include in
dot plot. Default 3}

\item{grouping_var}{Character; metadata column name for cluster identity.
Default 'seurat_clusters'}

\item{object_annotations}{Character; string to append to output file names.
Default ''}

\item{tables_path}{Character; path to save output tables. Default 'results/tables/'}

\item{figures_path}{Character; path to save figures. Default 'results/figures/'}

\item{results_path}{Character; path for pathway enrichment results. Default 'results/'}

\item{run_pathway_enrichment}{Character vector; enrichment methods to run
('Metascape', 'ClusterProfiler', or NULL). Default NULL}

\item{filter_ig}{Logical; whether to filter out immunoglobulin genes (Igh, Igl, Igk)
from FindAllMarkers results. Default FALSE}

\item{filter_tcr}{Logical; whether to filter out T cell receptor genes (Trav, Trbv,
Trdv, Trgv, Traj, Trbj, Trdj, Trgj, Trac, Trbc, Trdc, Trgc) from FindAllMarkers
results. Default FALSE}

\item{...}{Additional arguments passed to ClusterProfiler analysis}
}
\value{
List with elements:
\item{plot}{ggplot; dot plot of top marker genes}
\item{ClusterProfiler_results}{ClusterProfiler enrichment results or NULL}
\item{metascape_results}{Metascape enrichment results or NULL}
\item{topn}{Data frame; top n markers per cluster}
\item{top100}{Data frame; top 100 markers per cluster}
}
\description{
Identifies marker genes for each cluster using Seurat's FindAllMarkers and
generates a dot plot visualization. Saves ranked gene lists (top 10, 50, 100)
to TSV files and optionally performs pathway enrichment analysis using
Metascape and/or ClusterProfiler.
}
